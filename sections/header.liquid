{% comment %}
  Check if transparent header is enabled and on the home page template.
  This allows the theme editor to manage the state.
{% endcomment %}
{%- assign transparent_header = false -%}
{%- if template.name == 'index' and section.settings.enable_transparent_header -%}
  {%- assign transparent_header = true -%}
{%- endif -%}

<header
  class="header-main {% if section.settings.enable_sticky_header == 'always' %}is-sticky{% endif %} {% if transparent_header %}is-transparent{% endif %}"
  id="header-main"
>
  <div class="header-content container">
    <!-- Menu Toggle Button (Left) -->
    <div class="header-section header-left">
      <button class="menu-toggle" aria-controls="side-menu" aria-expanded="false">
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
        </svg>
      </button>
    </div>

    <!-- Logo (Center) -->
    <div class="header-section header-center">
      {%- if section.settings.logo != blank -%}
        {%- assign logo_width = section.settings.logo_width | default: 120 -%}
        <a href="{{ routes.root_url }}" class="logo-link">
          {{ section.settings.logo | image_url: width: 400 | image_tag: alt: section.settings.logo.alt, width: logo_width, class: 'logo' }}
        </a>
      {%- else -%}
        <h1 class="logo-text">
          <a href="{{ routes.root_url }}">{{ shop.name }}</a>
        </h1>
      {%- endif -%}
    </div>

    <!-- Action Icons (Right) -->
    <div class="header-section header-right">
      {%- if shop.customer_accounts_enabled -%}
        <a href="{{ routes.account_url }}" class="header-icon">
          <!-- User icon SVG -->
          <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-user" viewBox="0 0 64 64" width="24" height="24" fill="currentColor">
            <path d="M35 39.84v-2.53c3.3-1.91 6-6.66 6-11.41 0-7.63 0-13.82-9-13.82s-9 6.19-9 13.82c0 4.75 2.7 9.51 6 11.41v2.53c-10.18.85-18 6-18 12.16h42c0-6.19-7.82-11.31-18-12.16z"></path>
          </svg>
        </a>
      {%- endif -%}
      <a href="{{ routes.search_url }}" class="header-icon">
        <!-- Search icon SVG -->
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
          <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
        </svg>
      </a>
      <a href="{{ routes.cart_url }}" class="header-icon">
        <!-- Cart icon SVG -->
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
          <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
        </svg>
        <span class="cart-count">{{ cart.item_count }}</span>
      </a>
    </div>
  </div>

  <!-- Side Menu (initially hidden) -->
  <div class="side-menu" id="side-menu">
    <button class="menu-close">&times;</button>
    <nav class="side-nav">
      <ul>
        {% comment %} Iterate through a menu you create in the theme editor {% endcomment %}
        {%- for link in linklists.main-menu.links -%}
          <li><a href="{{ link.url }}">{{ link.title }}</a></li>
        {%- endfor -%}
        {%- if shop.customer_accounts_enabled -%}
          <li><a href="{{ routes.account_url }}">Account</a></li>
        {%- endif -%}
      </ul>
    </nav>
  </div>

  <!-- Search Overlay (Full-page) -->
  <div id="search-overlay" class="search-overlay">
    <div class="search-overlay-content container">
      <form action="{{ routes.search_url }}" method="get" role="search" style="width:100%;">
        <div class="search-input-wrapper">
          <input type="search"
                 name="q"
                 id="SearchInputOverlay"
                 class="search-input"
                 value="{{ search.terms | escape }}"
                 placeholder="Search our store"
                 aria-label="Search our store">
          <button type="submit" class="search-submit">
            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
          </button>
          <button class="search-close" aria-label="Close search">&times;</button>
        </div>
      </form>
    </div>
  </div>
</header>

<script src="{{ 'search-overlay.js' | asset_url }}" defer></script>

{% schema %}
  {
    "name": "Custom Header",
    "settings": [
      {
        "type": "image_picker",
        "id": "logo",
        "label": "t:settings.default_logo"
      },
      {
        "type": "range",
        "id": "logo_width",
        "min": 50,
        "max": 200,
        "step": 5,
        "unit": "px",
        "label": "t:settings.logo_width",
        "default": 120
      },
      {
        "type": "checkbox",
        "id": "enable_sticky_header",
        "label": "Enable Sticky Header",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "enable_transparent_header",
        "label": "Enable transparent header on home page",
        "default": false
      },
      {
        "type": "link_list",
        "id": "menu",
        "default": "main-menu",
        "label": "Menu for sidebar"
      }
    ]
  }

  {% endschema %}